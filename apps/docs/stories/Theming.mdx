import { Meta } from '@storybook/blocks';

<Meta title="Foundation/Theming" />

# 🎨 Theming System

The Sando Design System uses a **3-layer token architecture** that enables flexible theming through **Flavors**.

## Architecture Overview

```
┌─────────────────────────────────────────────────────────────┐
│  RECIPES Layer (Component Tokens)                           │
│  • Button, Card, Modal, etc.                                │
│  • --sando-button-solid-backgroundColor-default             │
└──────────────────────┬──────────────────────────────────────┘
                       ↓ references
┌─────────────────────────────────────────────────────────────┐
│  FLAVORS Layer (Semantic Tokens) ← YOU ARE HERE            │
│  • Original (Light), Original Dark, etc.                    │
│  • --sando-color-action-solid-background-default           │
└──────────────────────┬──────────────────────────────────────┘
                       ↓ references
┌─────────────────────────────────────────────────────────────┐
│  INGREDIENTS Layer (Primitive Tokens)                       │
│  • Colors, Spacing, Typography                              │
│  • --sando-color-brand-700: #2563eb                        │
└─────────────────────────────────────────────────────────────┘
```

## Sando's Color Philosophy

Sando provides **8 curated color palettes** + **3 neutral variants**, all scientifically designed using OKLCH for guaranteed accessibility and perceptual uniformity.

**Why 8 palettes?**
- ✅ Instant start (pick a palette, begin coding in 2 minutes)
- ✅ Scientific design (OKLCH, perceptually uniform)
- ✅ WCAG AA guaranteed (all palettes pass accessibility)
- ✅ Cover 95% of use cases

## Available Flavors

### 🍓 Strawberry (Default - Orange-based)
**Currently available** - The default light theme with:
- Warm backgrounds (`neutral-warm.100-200`)
- Dark text (`neutral-warm.800-950`)
- Orange brand colors for actions (`orange.600-800`)

**Palette:** Orange + Neutral Warm
**Use case:** Startups, creative agencies, food & beverage

### 🌊 Ocean (Blue-based)
**Coming soon** - Professional theme with:
- Cool backgrounds (`neutral-cool.50-100`)
- Dark text (`neutral-cool.900-950`)
- Blue brand colors (`blue.600-800`)

**Palette:** Blue + Neutral Cool
**Use case:** SaaS, finance, healthcare, corporate

### 🌲 Forest (Green-based)
**Coming soon** - Natural, growth-focused theme with:
- Neutral backgrounds (`neutral.50-100`)
- Dark text (`neutral.900-950`)
- Green brand colors (`green.600-800`)

**Palette:** Green + Neutral
**Use case:** Sustainability, health & wellness, finance

### 🌅 Sunset (Orange + Red)
**Coming soon** - Vibrant, bold theme with:
- Warm backgrounds (`neutral-warm.50-100`)
- Orange primary actions (`orange.600`)
- Red accent actions (`red.500`)

**Palette:** Orange + Red + Neutral Warm
**Use case:** Events, entertainment, creative work

## How to Switch Flavors

### In Storybook

Use the **Flavor** toolbar button (🎨) at the top:
- ☀️ Original (Light)
- 🌙 Original Dark

The entire UI will update instantly!

### In Your Application

#### Option 1: Static Import
```javascript
// Light mode
import '@sando/tokens/css/flavors/original.css';

// Dark mode
import '@sando/tokens/css/flavors/original-dark.css';
```

#### Option 2: Dynamic Switching
```javascript
function setFlavor(flavor) {
  // Remove existing flavor
  const existing = document.querySelector('link[data-flavor]');
  if (existing) existing.remove();

  // Add new flavor
  const link = document.createElement('link');
  link.rel = 'stylesheet';
  link.href = \`/tokens/css/flavors/\${flavor}.css\`;
  link.setAttribute('data-flavor', flavor);
  document.head.appendChild(link);
}

// Switch to dark mode
setFlavor('original-dark');
```

#### Option 3: System Preference
```javascript
const prefersDark = window.matchMedia('(prefers-color-scheme: dark)');

function updateFlavor(e) {
  setFlavor(e.matches ? 'original-dark' : 'original');
}

// Initial
updateFlavor(prefersDark);

// Listen for changes
prefersDark.addEventListener('change', updateFlavor);
```

## Creating Custom Flavors

### Option 1: Using Our Curated Palettes (Recommended)

1. **Create JSON file:**
```json
// packages/tokens/src/flavors/lavender.json
{
  "color": {
    "action": {
      "solid": {
        "background": {
          "default": { "value": "{color.purple.600.value}", "type": "color" }
        }
      }
    },
    "background": {
      "base": { "value": "{color.neutral-cool.50.value}", "type": "color" }
    }
  }
}
```

2. **Build tokens:**
```bash
cd packages/tokens
pnpm build
```

3. **Use your flavor:**
```javascript
import '@sando/tokens/css/flavors/lavender.css';
```

### Option 2: Generate Brand-Specific Palette (Coming Soon)

<div style={{ padding: '24px', background: '#FFF4E6', borderRadius: '8px', border: '2px solid #FFB020', marginTop: '24px' }}>
  <h4 style={{ marginTop: 0, color: '#C77700' }}>⚠️ Flavor Generator - Coming Soon</h4>
  <p>
    If none of our 8 palettes match your exact brand color, we're building a flavor generator:
  </p>
  <pre style={{ background: '#2D2D2D', color: '#E6E6E6', padding: '16px', borderRadius: '6px', overflow: 'auto' }}>
    <code>npx @sando/flavor-generator create --color "#FF6B00"</code>
  </pre>
  <p style={{ fontSize: '14px' }}>
    <strong>What it does:</strong><br/>
    • Generates a scientifically designed 11-step palette using OKLCH<br/>
    • Validates WCAG AA accessibility automatically<br/>
    • Creates light + dark mode flavor variants<br/>
    • Outputs ready-to-use token files
  </p>
  <p style={{ fontSize: '14px', marginBottom: 0 }}>
    <strong>Status:</strong> Under development | <strong>Timeline:</strong> Q2 2025 | <strong>Priority:</strong> High
  </p>
</div>

## Token Customization

All flavors expose the same CSS custom properties, so components work with any flavor:

```css
/* These work in ANY flavor */
.my-component {
  background: var(--sando-color-background-base);
  color: var(--sando-color-text-body);
  padding: var(--sando-space-inset-default);
}
```

## Best Practices

### ✅ DO
- Use semantic tokens from Flavors layer (`--sando-color-background-base`)
- Test components in both light and dark modes
- Ensure 4.5:1 contrast ratio for text
- Provide flavor switching UI for users

### ❌ DON'T
- Use primitive tokens directly (`--sando-color-neutral-700`) in components
- Hard-code color values
- Assume light mode only
- Ignore accessibility in dark mode

## Accessibility

All flavors are designed to meet **WCAG 2.1 Level AA**:
- Text contrast ratio ≥ 4.5:1
- Interactive elements ≥ 3:1
- Focus indicators clearly visible
- Tested with screen readers

## Performance

- **CSS size:** ~5-6 KB per flavor (gzipped)
- **Load time:** Instant with dynamic switching
- **Tree-shakeable:** Only load flavors you use
- **No JavaScript required:** Pure CSS

## Roadmap

Future flavors planned:
- 🎨 **High Contrast:** For accessibility
- 🌈 **Colorful:** Vibrant palette
- 💼 **Corporate:** Professional/neutral
- 🎮 **Gaming:** Bold and energetic

---

**Questions?** Check out the [Design Tokens](/?path=/docs/foundation-design-tokens--docs) documentation.
